{% extends 'base.html' %}
{% load static %}
{% block title %}Каталог книг — Читательский дневник{% endblock %}

{% block content %}
<section class="catalog">
  <h2 class="catalog__title">Каталог книг</h2>

  <div class="catalog__wrapper">

    <!-- Sidebar фильтры -->
    <aside class="catalog__filters-sidebar">
      <form method="GET" action="{% url 'catalog' %}" id="filter-form" class="filter-form">

        <div class="filter-form__group">
          <label for="search" class="filter-form__label"> Поиск</label>
          <input
            type="search"
            id="search"
            name="q"
            value="{{ request.GET.q|default:'' }}"
            placeholder="Название или автор"
            class="filter-form__input"
            autocomplete="off"
          />
        </div>

        <div class="filter-form__group">
          <label for="genre" class="filter-form__label"> Жанр</label>
          <select name="genre" id="genre" class="filter-form__select" title="Выберите жанр">
            <option value="">Все жанры</option>
            {% for genre in genres %}
              <option value="{{ genre.id }}" {% if genre.id|stringformat:"s" == request.GET.genre %}selected{% endif %}>{{ genre.name }}</option>
            {% endfor %}
          </select>
        </div>

        <div class="filter-form__group">
          <label for="author" class="filter-form__label"> Автор</label>
          <select name="author" id="author" class="filter-form__select" title="Выберите автора">
            <option value="">Все авторы</option>
            {% for author in authors %}
              <option value="{{ author.id }}" {% if author.id|stringformat:"s" == request.GET.author %}selected{% endif %}>{{ author.name }}</option>
            {% endfor %}
          </select>
        </div>

        <div class="filter-form__group">
          <label for="year" class="filter-form__label"> Год издания</label>
          <input
            type="number"
            name="year"
            id="year"
            value="{{ request.GET.year|default:'' }}"
            placeholder="Например, 2020"
            class="filter-form__input"
            min="1500" max="2100"
          />
        </div>

        <div class="filter-form__buttons">
          <button type="submit" class="btn btn--primary">Применить</button>
          <a href="{% url 'catalog' %}" class="btn btn--reset">Сбросить</a>
        </div>
      </form>
    </aside>

    <div class="catalog__books">

      {% if books %}
        <div class="books-grid">
          {% for book in books %}
            <article class="book-card" tabindex="0" aria-label="Книга {{ book.title }}">
              {% if book.cover %}
                <img
                  src="{{ book.cover.url }}"
                  alt="Обложка книги {{ book.title }}"
                  class="book-card__image"
                  loading="lazy"
                />
              {% else %}
                <img
                  src="{% static 'images/default_cover.jpg' %}"
                  alt="Обложка книги {{ book.title }}"
                  class="book-card__image"
                  loading="lazy"
                />
              {% endif %}
              <div class="book-card__info">
                <h3 class="book-card__title">{{ book.title }}</h3>
                <p class="book-card__author">Автор:  <span>{{ book.author.name }}</span></p>
                <p class="book-card__genre">Жанр:  <span>{{ book.genre.name }}</span></p>
                <a href="{% url 'book_detail' book.id %}" class="book-card__button" aria-label="Подробнее о книге {{ book.title }}">Подробнее</a>
              </div>



              
            </article>
          {% endfor %}
        </div>
      {% else %}
        <p>Книг не найдено.</p>
      {% endif %}

    </div>


    <section class="sliders" >
<a href="{% url 'author' %}" class="nav__link" style="color: rgb(108, 91, 59); font-size: 25px; padding: 2%;">Все авторы</a>
<div class="slider slider-authors">
  {% for author in authors %}
    <a href="{% url 'author_detail' author.id %}" class="slider-item" tabindex="0" aria-label="Автор {{ author.name }}">
      {% if author.photo %}
        <img src="{{ author.photo.url }}" alt="Фото автора {{ author.name }}" class="slider-item__image" loading="lazy" />
      {% else %}
        <div class="slider-item__placeholder">{{ author.name|slice:":1" }}</div>
      {% endif %}
      <span class="slider-item__name">{{ author.name }}</span>
    </a>
  {% endfor %}
</div>

    <a href="{% url 'genres' %}" class="nav__link" style="color: rgb(108, 91, 59); font-size: 25px; padding: 2%;">Все жанры</a>

<div class="slider slider-genres">
  {% for genre in genres %}
    <a href="{% url 'genre_detail' genre.id %}" class="slider-item" tabindex="0" aria-label="Жанр {{ genre.name }}">
      <div class="slider-item__placeholder genre-placeholder">{{ genre.name|slice:":1" }}</div>
      <span class="slider-item__name">{{ genre.name }}</span>
    </a>
  {% endfor %}
</div>


</section>


  </div>
</section>





{% endblock %}
